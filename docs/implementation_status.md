# 現在の実装状況

**日付**: 2025-12-07
**プロジェクト**: LatestInformationDiscussionAgents

本書は、初期セットアップ段階における現在の実装状況をまとめたものです。

## 1. フォルダ構成

プロジェクトの構造は以下のように初期化されています：

```
LatestInformationDiscussionAgents/
├── docs/                   # ドキュメント (本フォルダ)
├── src/
│   ├── agents/             # エージェントロジックの実装
│   ├── core/               # オーケストレーションロジック (LangGraph)
│   ├── models/             # データスキーマ (Pydantic)
│   ├── ui/                 # ユーザーインターフェース (Streamlit)
│   └── utils/              # ユーティリティ (LLM, ツール)
├── main.py                 # CLIエントリーポイント
├── requirements.txt        # 依存ライブラリ
└── .env                    # 設定 (APIキー)
```

## 2. コンポーネントの状態

すべてのコンポーネントは**スケルトン/プレースホルダー**として作成されています。コアとなるビジネスロジック（プロンプト、実際の処理）はまだ実装されていません。

### エージェント (`src/agents/`)
| エージェントファイル | 役割 | 現在の状態 | 未実装のロジック |
| :--- | :--- | :--- | :--- |
| `researcher.py` | ニュース記事取得 (フェーズ 0) | クラス定義済み。`run` メソッドは固定文字列を返す。 | Tavily検索の統合、コンテンツ抽出。 |
| `analyst_optimistic.py` | 楽観的分析 (フェーズ 1, 3) | クラス定義済み。`analyze`/`debate` メソッドはモック文字列を返す。 | 楽観的視点のLLMプロンプト、主張生成、反論ロジック。 |
| `analyst_pessimistic.py` | 悲観的分析 (フェーズ 1, 3) | クラス定義済み。`analyze`/`debate` メソッドはモック文字列を返す。 | 悲観的視点のLLMプロンプト、主張生成、反論ロジック。 |
| `fact_checker.py` | ファクトチェック (フェーズ 2) | クラス定義済み。`validate` メソッドはモック文字列を返す。 | バイアス検知と事実検証のためのLLMプロンプト。 |
| `reporter.py` | 最終レポート (フェーズ 4) | クラス定義済み。`create_report` メソッドはモック文字列を返す。 | 統合ロジック、レポート整形プロンプト。 |

### コアロジック (`src/core/`)
- **`state.py`**:
    - `DiscussionState` (TypedDict) が定義され、主張、批評、最終レポートのフィールドを持つ。
    - **注記**: 「反論」(フェーズ 3の出力) 用の具体的なフィールドが現在欠けている。
- **`graph.py`**:
    - `StateGraph` が定義され、Researcher -> Analysts -> Checker -> Reporter -> End と接続されている。
    - **状態**: フローは直線的で簡素化されている。「討論」フェーズ (フェーズ 3) のループや、並列実行（LangGraphは分岐を処理するが）の厳密な定義はまだない。

### モデル (`src/models/`)
- **`schemas.py`**: 基本的なPydanticモデル (`Argument`, `Critique`, `FinalReport`) が定義されている。

### ユーザーインターフェース (`src/ui/`)
- **`streamlit_app.py`**:
    - 基本的なUIが実装されている。
    - 入力: トピック/URL、APIキー。
    - 出力: グラフからのモック辞書出力を表示。
    - **状態**: モック化されたグラフに接続済み。

## 3. 実装待ちタスク

`仕様.md` に基づいてシステムを完成させるためには、以下のロジックを実装する必要があります：

1.  **検索統合**: `ResearcherAgent` に `TavilySearchResults` を実装する。
2.  **LLMプロンプト**: 各エージェントの役割（楽観派、悲観派、チェッカー、レポーター）に応じた具体的な `ChatPromptTemplate` を記述する。
3.  **構造化出力**: エージェントが `.with_structured_output()` 等を使用して `src/models/schemas.py` に一致するデータを返すようにする。
4.  **討論ロジック**:
    - `DiscussionState` を更新し、反論データを保持できるようにする。
    - `graph.py` を更新し、アナリストが批評に応答する「討論」ステップ (フェーズ 3) を含める。
5.  **グラフの洗練**: ステップ間でデータが正しく渡されるようにする（例：記事をアナリストへ、主張をチェッカーへ）。

